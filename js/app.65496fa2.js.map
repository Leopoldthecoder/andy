{"version":3,"sources":["webpack:///./src/utils.js","webpack:///./src/colors.js","webpack:///src/App.vue","webpack:///./src/App.vue?2f9d","webpack:///./src/App.vue","webpack:///./src/main.js"],"names":["base64Img2Blob","code","parts","split","contentType","raw","window","atob","rawLength","length","uInt8Array","Uint8Array","i","charCodeAt","Blob","type","getObjectUrl","content","URL","createObjectURL","hex2rgb","str","hex","replace","r","parseInt","slice","g","b","getBreakpoints","_ref","height","width","x","y","colors","level1","level2","level3","IMAGE_WIDTH","App","fileName","data","avg","ratio","factor","canvas","level","_hex2rgb","block","putImageData","ImageData","Uint8ClampedArray","newData","this","points","toLowerCase","anchor","imageSrc","click","imageHeight","postProcess","_this$config","config","grayscale","invert","contrast","applyPopArtColors","_this","val","h","attrs","gray","drawToImage","close","App_render","_vm","_h","$createElement","_c","_self","id","class","picked","file","placeholder","accept","icon","on-change","onFilePick","capture","theme","no-mask","model","value","callback","$$v","expression","ref","staticClass","directives","name","rawName","src","alt","_v","on","configure","download","_e","staticRenderFns","__vue_template_functional__","__vue_styles__","__vue_scopeId__","__vue_module_identifier__","Component","Object","component_normalizer","src_App","vue_runtime_esm","productionTip","component","VueImgInputer_default","a","use","button_default","action_sheet_default","switch_default","range_default","list_default","list_item_default","render","$mount"],"mappings":"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","file":"js/app.65496fa2.js","sourcesContent":["const base64Img2Blob = code => {\n  const parts = code.split(';base64,')\n  const contentType = parts[0].split(':')[1]\n  const raw = window.atob(parts[1])\n  const rawLength = raw.length\n\n  const uInt8Array = new Uint8Array(rawLength)\n\n  for (let i = 0; i < rawLength; ++i) {\n    uInt8Array[i] = raw.charCodeAt(i)\n  }\n\n  return new Blob([uInt8Array], { type: contentType })\n}\n\nexport function getObjectUrl (content) {\n  return URL.createObjectURL(base64Img2Blob(content))\n}\n\nexport function hex2rgb (str) {\n  const hex = str.replace('#', '')\n  return {\n    r: parseInt(hex.slice(0, 2), 16),\n    g: parseInt(hex.slice(2, 4), 16),\n    b: parseInt(hex.slice(4, 6), 16)\n  }\n}\n\nexport function getBreakpoints ({ height, width }) {\n  return [{\n    x: 0,\n    y: 0\n  }, {\n    x: width / 2,\n    y: 0\n  }, {\n    x: 0,\n    y: height / 2\n  }, {\n    x: width / 2,\n    y: height / 2\n  }]\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/utils.js","export default [{\n  level1: '#52295f',\n  level2: '#85469b',\n  level3: '#DAEDCA'\n}, {\n  level1: '#2d3b5f',\n  level2: '#4a519b',\n  level3: '#ECE66F'\n}, {\n  level1: '#364135',\n  level2: '#677d64',\n  level3: '#E55849'\n}, {\n  level1: '#5f1618',\n  level2: '#9b2227',\n  level3: '#DADCF8'\n}]\n\n\n\n// WEBPACK FOOTER //\n// ./src/colors.js","<template>\n  <div id=\"app\">\n    <img-input\n      v-model=\"file\"\n      :class=\"{ 'picked': file }\"\n      placeholder=\"点击选择图片\"\n      accept=\"image/*\"\n      icon=\"img\"\n      :on-change=\"onFilePick\"\n      :capture=\"false\"\n      theme=\"light\"\n      no-mask>\n    </img-input>\n\n    <section v-if=\"file\">\n      <canvas ref=\"canvas\" class=\"hidden\"></canvas>\n      <img\n        class=\"output\"\n        :src=\"imageSrc\"\n        alt=\"output\"\n        v-show=\"ready\">\n\n      <p v-show=\"showWeixinTip\" class=\"weixin-tip\">\n        轻触图片，在图片放大后<br>长按图片并选择「保存图片」\n      </p>\n\n      <em-button @click=\"configure\" type=\"text\">设置</em-button>\n      <span>|</span>\n      <em-button @click=\"download\" type=\"text\">下载</em-button>\n\n      <a class=\"hidden\" ref=\"anchor\">download</a>\n    </section>\n  </div>\n</template>\n\n<script>\nimport { hex2rgb, getObjectUrl, getBreakpoints } from './utils'\nimport colors from './colors'\n\nconst IMAGE_WIDTH = 200\n\nexport default {\n  name: 'app',\n\n  data () {\n    return {\n      ready: false,\n      file: null,\n      imageData: null,\n      imageSrc: '',\n      ctx: null,\n      points: [],\n      config: {\n        gray: true,\n        invert: false,\n        contrast: 100\n      },\n      showWeixinTip: false\n    }\n  },\n\n  methods: {\n    onFilePick (file, fileName) {\n      this.fileName = fileName\n      this.showWeixinTip = false\n      this.config = {\n        gray: true,\n        invert: false,\n        contrast: 100\n      }\n      setTimeout(this.drawToImage, 200)\n    },\n\n    grayscale () {\n      const data = this.imageData.data\n      for (let i = 0; i < data.length; i += 4) {\n        const avg = (data[i] + data[i + 1] + data[i + 2]) / 3\n        data[i] = avg\n        data[i + 1] = avg\n        data[i + 2] = avg\n      }\n      this.ctx.putImageData(this.imageData, 0, 0)\n    },\n\n    invert () {\n      const data = this.imageData.data\n      for (let i = 0; i < data.length; i += 4) {\n        data[i] = 255 - data[i]\n        data[i + 1] = 255 - data[i + 1]\n        data[i + 2] = 255 - data[i + 2]\n      }\n      this.ctx.putImageData(this.imageData, 0, 0)\n    },\n\n    contrast (deg) {\n      const data = this.imageData.data\n      const ratio = (deg / 100) + 1\n      const factor = 128 * (1 - ratio)\n      for (let i = 0; i < data.length; i += 4) {\n        data[i] = data[i] * ratio + factor\n        data[i + 1] = data[i + 1] * ratio + factor\n        data[i + 2] = data[i + 2] * ratio + factor\n      }\n      this.ctx.putImageData(this.imageData, 0, 0)\n    },\n\n    applyPopArtColors () {\n      const data = this.imageData.data\n      const canvas = this.$refs.canvas\n      this.points = getBreakpoints(canvas)\n      for (let block = 0; block < 4; block++) {\n        const newData = []\n        for (let i = 0; i < data.length; i += 4) {\n          let level\n          if (data[i] < 86) {\n            level = 'level1'\n          } else if (data[i] < 171) {\n            level = 'level2'\n          } else {\n            level = 'level3'\n          }\n          const { r, g, b } = hex2rgb(colors[block][level])\n          newData.push(r, g, b, data[i + 3])\n        }\n        this.ctx.putImageData(\n          new ImageData(new Uint8ClampedArray(newData), IMAGE_WIDTH, canvas.height / 2),\n          this.points[block].x,\n          this.points[block].y\n        )\n      }\n      this.imageSrc = getObjectUrl(this.$refs.canvas.toDataURL('image/png'))\n      this.ready = true\n    },\n\n    download () {\n      const ua = navigator.userAgent.toLowerCase()\n      if (/micromessenger/.test(ua)) {\n        this.showWeixinTip = true\n        return\n      }\n      const a = this.$refs.anchor\n      a.download = this.fileName\n      a.href = this.imageSrc\n      a.click()\n    },\n\n    drawToImage () {\n      const img = document.getElementsByTagName('img')[0]\n      const canvas = this.$refs.canvas\n      const imageHeight = Math.round(IMAGE_WIDTH * img.height / img.width)\n      canvas.height = 2 * imageHeight\n      canvas.width = 2 * IMAGE_WIDTH\n      this.ctx = canvas.getContext('2d')\n      this.ctx.drawImage(img, 0, 0, IMAGE_WIDTH, imageHeight)\n      this.imageData = this.ctx.getImageData(0, 0, IMAGE_WIDTH, imageHeight)\n      this.postProcess()\n    },\n\n    postProcess () {\n      const { gray, invert, contrast } = this.config\n      if (gray) {\n        this.grayscale()\n      }\n      if (invert) {\n        this.invert()\n      }\n      if (contrast !== 0) {\n        this.contrast(contrast)\n      }\n      this.applyPopArtColors()\n    },\n\n    configure () {\n      const onInput = (val, prop) => {\n        this.config[prop] = val\n      }\n      const close = this.$actionsheet({\n        closeOnClickModal: false,\n        lockScroll: true,\n        items: [\n          () => (\n            <em-list>\n              <em-list-item title=\"对图片作灰度处理\">\n                <em-switch\n                  value={this.config.gray}\n                  on-input={ val => onInput(val, 'gray') }>\n                </em-switch>\n              </em-list-item>\n              <em-list-item title=\"对图片作反色处理\">\n                <em-switch\n                  value={this.config.invert}\n                  on-input={ val => onInput(val, 'invert') }>\n                </em-switch>\n              </em-list-item>\n              <em-list-item title={`图片对比度：${this.config.contrast}`}>\n                <em-range\n                  min={-50}\n                  max={200}\n                  value={this.config.contrast}\n                  on-input={ val => onInput(val, 'contrast') }>\n                </em-range>\n              </em-list-item>\n            </em-list>\n          ),\n          {\n            text: '确定',\n            type: 'primary',\n            onClick: () => {\n              this.drawToImage()\n              close()\n            }\n          }\n        ]\n      })\n    }\n  }\n}\n</script>\n\n\n\n// WEBPACK FOOTER //\n// src/App.vue","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"app\"}},[_c('img-input',{class:{ 'picked': _vm.file },attrs:{\"placeholder\":\"点击选择图片\",\"accept\":\"image/*\",\"icon\":\"img\",\"on-change\":_vm.onFilePick,\"capture\":false,\"theme\":\"light\",\"no-mask\":\"\"},model:{value:(_vm.file),callback:function ($$v) {_vm.file=$$v},expression:\"file\"}}),(_vm.file)?_c('section',[_c('canvas',{ref:\"canvas\",staticClass:\"hidden\"}),_c('img',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.ready),expression:\"ready\"}],staticClass:\"output\",attrs:{\"src\":_vm.imageSrc,\"alt\":\"output\"}}),_c('p',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.showWeixinTip),expression:\"showWeixinTip\"}],staticClass:\"weixin-tip\"},[_vm._v(\"\\n      轻触图片，在图片放大后\"),_c('br'),_vm._v(\"长按图片并选择「保存图片」\\n    \")]),_c('em-button',{attrs:{\"type\":\"text\"},on:{\"click\":_vm.configure}},[_vm._v(\"设置\")]),_c('span',[_vm._v(\"|\")]),_c('em-button',{attrs:{\"type\":\"text\"},on:{\"click\":_vm.download}},[_vm._v(\"下载\")]),_c('a',{ref:\"anchor\",staticClass:\"hidden\"},[_vm._v(\"download\")])],1):_vm._e()],1)}\nvar staticRenderFns = []\nexport { render, staticRenderFns }\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./node_modules/vue-loader/lib/template-compiler?{\"id\":\"data-v-5dbc7320\",\"hasScoped\":false,\"optionsId\":\"0\",\"buble\":{\"transforms\":{}}}!./node_modules/vue-loader/lib/selector.js?type=template&index=0!./src/App.vue\n// module id = null\n// module chunks = ","/* script */\nexport * from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/Users/yangyi/andy/node_modules/.cache/cache-loader\\\"}!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\nimport __vue_script__ from \"!!cache-loader?{\\\"cacheDirectory\\\":\\\"/Users/yangyi/andy/node_modules/.cache/cache-loader\\\"}!babel-loader!../node_modules/vue-loader/lib/selector?type=script&index=0!./App.vue\"\n/* template */\nimport {render as __vue_render__, staticRenderFns as __vue_static_render_fns__} from \"!!../node_modules/vue-loader/lib/template-compiler/index?{\\\"id\\\":\\\"data-v-5dbc7320\\\",\\\"hasScoped\\\":false,\\\"optionsId\\\":\\\"0\\\",\\\"buble\\\":{\\\"transforms\\\":{}}}!../node_modules/vue-loader/lib/selector?type=template&index=0!./App.vue\"\n/* template functional */\nvar __vue_template_functional__ = false\n/* styles */\nvar __vue_styles__ = null\n/* scopeId */\nvar __vue_scopeId__ = null\n/* moduleIdentifier (server only) */\nvar __vue_module_identifier__ = null\nimport normalizeComponent from \"!../node_modules/vue-loader/lib/runtime/component-normalizer\"\nvar Component = normalizeComponent(\n  __vue_script__,\n  __vue_render__,\n  __vue_static_render_fns__,\n  __vue_template_functional__,\n  __vue_styles__,\n  __vue_scopeId__,\n  __vue_module_identifier__\n)\n\nexport default Component.exports\n\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./src/App.vue\n// module id = null\n// module chunks = ","import Vue from 'vue'\nimport ImgInput from 'vue-img-inputer'\nimport {\n  Button,\n  ActionSheet,\n  Switch,\n  Range,\n  List,\n  ListItem\n} from 'element-mobile'\nimport App from './App.vue'\nimport './style/index.scss'\nimport './style/element-mobile-override.css'\n\nVue.config.productionTip = false\nVue.component('ImgInput', ImgInput)\nVue.use(Button)\nVue.use(ActionSheet)\nVue.use(Switch)\nVue.use(Range)\nVue.use(List)\nVue.use(ListItem)\n\nnew Vue({\n  render: h => h(App)\n}).$mount('#app')\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js"],"sourceRoot":""}