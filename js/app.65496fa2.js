webpackJsonp([1],{"+qiL":function(t,e){},"/7R1":function(t,e){},0:function(t,e,a){t.exports=a("NHnr")},"5Mqt":function(t,e){},"83Q+":function(t,e){},F2hG:function(t,e){},Jee6:function(t,e){},NHnr:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});a("/7R1");var i=a("NXeV"),n=a.n(i),s=(a("83Q+"),a("NV2l")),r=a.n(s),o=(a("F2hG"),a("iG82")),c=a.n(o),l=(a("uTvk"),a("7RWe")),u=a.n(l),h=(a("5Mqt"),a("2UXc")),f=a.n(h),g=(a("gouP"),a("Ck2a")),m=a.n(g),v=a("/5sW"),p=a("kwPQ"),d=a.n(p),w=(a("MyjO"),a("VjuZ"),a("TFWu"),a("mJx5"),function(t){for(var e=t.split(";base64,"),a=e[0].split(":")[1],i=window.atob(e[1]),n=i.length,s=new Uint8Array(n),r=0;r<n;++r)s[r]=i.charCodeAt(r);return new Blob([s],{type:a})});function x(t){return URL.createObjectURL(w(t))}function y(t){var e=t.replace("#","");return{r:parseInt(e.slice(0,2),16),g:parseInt(e.slice(2,4),16),b:parseInt(e.slice(4,6),16)}}function D(t){var e=t.height,a=t.width;return[{x:0,y:0},{x:a/2,y:0},{x:0,y:e/2},{x:a/2,y:e/2}]}var b=[{level1:"#52295f",level2:"#85469b",level3:"#DAEDCA"},{level1:"#2d3b5f",level2:"#4a519b",level3:"#ECE66F"},{level1:"#364135",level2:"#677d64",level3:"#E55849"},{level1:"#5f1618",level2:"#9b2227",level3:"#DADCF8"}],k=200,C={name:"app",data:function(){return{ready:!1,file:null,imageData:null,imageSrc:"",ctx:null,points:[],config:{gray:!0,invert:!1,contrast:100},showWeixinTip:!1}},methods:{onFilePick:function(t,e){this.fileName=e,this.showWeixinTip=!1,this.config={gray:!0,invert:!1,contrast:100},setTimeout(this.drawToImage,200)},grayscale:function(){for(var t=this.imageData.data,e=0;e<t.length;e+=4){var a=(t[e]+t[e+1]+t[e+2])/3;t[e]=a,t[e+1]=a,t[e+2]=a}this.ctx.putImageData(this.imageData,0,0)},invert:function(){for(var t=this.imageData.data,e=0;e<t.length;e+=4)t[e]=255-t[e],t[e+1]=255-t[e+1],t[e+2]=255-t[e+2];this.ctx.putImageData(this.imageData,0,0)},contrast:function(t){for(var e=this.imageData.data,a=t/100+1,i=128*(1-a),n=0;n<e.length;n+=4)e[n]=e[n]*a+i,e[n+1]=e[n+1]*a+i,e[n+2]=e[n+2]*a+i;this.ctx.putImageData(this.imageData,0,0)},applyPopArtColors:function(){var t=this.imageData.data,e=this.$refs.canvas;this.points=D(e);for(var a=0;a<4;a++){for(var i=[],n=0;n<t.length;n+=4){var s=void 0;s=t[n]<86?"level1":t[n]<171?"level2":"level3";var r=y(b[a][s]),o=r.r,c=r.g,l=r.b;i.push(o,c,l,t[n+3])}this.ctx.putImageData(new ImageData(new Uint8ClampedArray(i),k,e.height/2),this.points[a].x,this.points[a].y)}this.imageSrc=x(this.$refs.canvas.toDataURL("image/png")),this.ready=!0},download:function(){var t=navigator.userAgent.toLowerCase();if(/micromessenger/.test(t))this.showWeixinTip=!0;else{var e=this.$refs.anchor;e.download=this.fileName,e.href=this.imageSrc,e.click()}},drawToImage:function(){var t=document.getElementsByTagName("img")[0],e=this.$refs.canvas,a=Math.round(k*t.height/t.width);e.height=2*a,e.width=2*k,this.ctx=e.getContext("2d"),this.ctx.drawImage(t,0,0,k,a),this.imageData=this.ctx.getImageData(0,0,k,a),this.postProcess()},postProcess:function(){var t=this.config,e=t.gray,a=t.invert,i=t.contrast;e&&this.grayscale(),a&&this.invert(),0!==i&&this.contrast(i),this.applyPopArtColors()},configure:function(){var t=this,e=this.$createElement,a=function(e,a){t.config[a]=e},i=this.$actionsheet({closeOnClickModal:!1,lockScroll:!0,items:[function(){return e("em-list",[e("em-list-item",{attrs:{title:"对图片作灰度处理"}},[e("em-switch",{attrs:{value:t.config.gray},on:{input:function(t){return a(t,"gray")}}})]),e("em-list-item",{attrs:{title:"对图片作反色处理"}},[e("em-switch",{attrs:{value:t.config.invert},on:{input:function(t){return a(t,"invert")}}})]),e("em-list-item",{attrs:{title:"图片对比度：".concat(t.config.contrast)}},[e("em-range",{attrs:{min:-50,max:200,value:t.config.contrast},on:{input:function(t){return a(t,"contrast")}}})])])},{text:"确定",type:"primary",onClick:function(){t.drawToImage(),i()}}]})}}},I=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{attrs:{id:"app"}},[a("img-input",{class:{picked:t.file},attrs:{placeholder:"点击选择图片",accept:"image/*",icon:"img","on-change":t.onFilePick,capture:!1,theme:"light","no-mask":""},model:{value:t.file,callback:function(e){t.file=e},expression:"file"}}),t.file?a("section",[a("canvas",{ref:"canvas",staticClass:"hidden"}),a("img",{directives:[{name:"show",rawName:"v-show",value:t.ready,expression:"ready"}],staticClass:"output",attrs:{src:t.imageSrc,alt:"output"}}),a("p",{directives:[{name:"show",rawName:"v-show",value:t.showWeixinTip,expression:"showWeixinTip"}],staticClass:"weixin-tip"},[t._v("\n      轻触图片，在图片放大后"),a("br"),t._v("长按图片并选择「保存图片」\n    ")]),a("em-button",{attrs:{type:"text"},on:{click:t.configure}},[t._v("设置")]),a("span",[t._v("|")]),a("em-button",{attrs:{type:"text"},on:{click:t.download}},[t._v("下载")]),a("a",{ref:"anchor",staticClass:"hidden"},[t._v("download")])],1):t._e()],1)},T=[],_=a("XyMi"),P=!1,A=null,N=null,W=null,$=Object(_["a"])(C,I,T,P,A,N,W),E=$.exports;a("+qiL"),a("Jee6");v["default"].config.productionTip=!1,v["default"].component("ImgInput",d.a),v["default"].use(m.a),v["default"].use(f.a),v["default"].use(u.a),v["default"].use(c.a),v["default"].use(r.a),v["default"].use(n.a),new v["default"]({render:function(t){return t(E)}}).$mount("#app")},gouP:function(t,e){},uTvk:function(t,e){}},[0]);
//# sourceMappingURL=app.65496fa2.js.map